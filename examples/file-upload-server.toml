# Configuration for servers that handle file uploads
# Balanced protection while allowing legitimate large uploads

[general]
interface = "eth0"
xdp_mode = "native"
timeout = 0

[ports]
ports_to_protect = "80,443"

[per_ip_limits]
# Generous bandwidth limits for file uploads
per_ip_pps_limit = 20000          # High packet rate for large files
per_ip_syn_pps_limit = 100        # Still protect against SYN flood
per_ip_udp_pps_limit = 5000       # Lower UDP (uploads are TCP)
per_ip_udp_bps_limit = 10485760   # 10 MB/s UDP
per_ip_bps_limit = 209715200      # 200 MB/s - allows fast uploads!
action = "drop"

[per_flow_limits]
# Per-connection limits (more lenient for uploads)
per_flow_pps_limit = 15000        # High for sustained upload
per_flow_syn_pps_limit = 50
per_flow_udp_pps_limit = 2500
per_flow_udp_bps_limit = 5242880   # 5 MB/s
per_flow_bps_limit = 104857600     # 100 MB/s per connection
action = "drop"

[whitelist]
# Whitelist authenticated users or trusted networks
preload_whitelist_file = "/etc/slice-xdp/whitelist.txt"

[blacklist]
preload_blacklist_file = "/etc/slice-xdp/blacklist.txt"

[alerting]
alert = "log"
log_file = "/var/log/slice-xdp/file-upload.log"
webhook_url = ""

[alerting.enable]
# Alert on unusual patterns but not normal upload traffic
per_ip_pps = true
per_ip_syn_pps = true
per_ip_udp_pps = true
per_ip_udp_bps = false        # Don't alert on legitimate uploads
per_ip_bps = false            # Don't alert on legitimate uploads
per_flow_pps = false
per_flow_syn_pps = true
per_flow_udp_pps = false
per_flow_udp_bps = false
per_flow_bps = false
other = true

